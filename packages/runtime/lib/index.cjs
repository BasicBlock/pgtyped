"use strict";var tt=Object.create;var $=Object.defineProperty;var xt=Object.getOwnPropertyDescriptor;var rt=Object.getOwnPropertyNames;var st=Object.getPrototypeOf,it=Object.prototype.hasOwnProperty;var nt=(t,e)=>{for(var x in e)$(t,x,{get:e[x],enumerable:!0})},Se=(t,e,x,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of rt(e))!it.call(t,n)&&n!==x&&$(t,n,{get:()=>e[n],enumerable:!(r=xt(e,n))||r.enumerable});return t};var N=(t,e,x)=>(x=t!=null?tt(st(t)):{},Se(e||!t||!t.__esModule?$(x,"default",{value:t,enumerable:!0}):x,t)),at=t=>Se($({},"__esModule",{value:!0}),t);var Et={};nt(Et,{ParameterTransform:()=>L,PreparedQuery:()=>me,TaggedQuery:()=>W,processSQLQueryIR:()=>G,processTSQueryAST:()=>C,sql:()=>Xe});module.exports=at(Et);var L=(n=>(n[n.Scalar=0]="Scalar",n[n.Spread=1]="Spread",n[n.Pick=2]="Pick",n[n.PickSpread=3]="PickSpread",n))(L||{});function Y(t,e){if(e.length===0)return t;e.sort((n,h)=>n.a-h.a);let x=0,r="";for(let n of e){let h=t.slice(0,n.a+x),c=t.slice(n.b+x+1,t.length);r=h+n.sub+c,x+=r.length-t.length,t=r}return r}var te=require("antlr4ts"),Fe=require("antlr4ts/tree/ParseTreeWalker.js");var Ie=require("antlr4ts/atn/ATNDeserializer.js"),Me=require("antlr4ts/Lexer.js"),Ce=require("antlr4ts/atn/LexerATNSimulator.js"),Ne=require("antlr4ts/VocabularyImpl.js"),Le=N(require("antlr4ts/misc/Utils.js"),1),p=class t extends Me.Lexer{get vocabulary(){return t.VOCABULARY}constructor(e){super(e),this._interp=new Ce.LexerATNSimulator(t._ATN,this)}get grammarFileName(){return"QueryLexer.g4"}get ruleNames(){return t.ruleNames}get serializedATN(){return t._serializedATN}get channelNames(){return t.channelNames}get modeNames(){return t.modeNames}static get _ATN(){return t.__ATN||(t.__ATN=new Ie.ATNDeserializer().deserialize(Le.toCharArray(t._serializedATN))),t.__ATN}};p.ID=1;p.SINGULAR_PARAM_MARK=2;p.PLURAL_PARAM_MARK=3;p.COMMA=4;p.OB=5;p.CB=6;p.WORD=7;p.REQUIRED_MARK=8;p.SPECIAL=9;p.EOF_STATEMENT=10;p.WSL=11;p.STRING=12;p.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"];p.modeNames=["DEFAULT_MODE"];p.ruleNames=["QUOT","ID","SID","SINGULAR_PARAM_MARK","PLURAL_PARAM_MARK","COMMA","OB","CB","WORD","REQUIRED_MARK","SPECIAL","EOF_STATEMENT","WSL","STRING"];p._LITERAL_NAMES=[void 0,void 0,"'$'","'$$'","','","'('","')'",void 0,"'!'",void 0,"';'"];p._SYMBOLIC_NAMES=[void 0,"ID","SINGULAR_PARAM_MARK","PLURAL_PARAM_MARK","COMMA","OB","CB","WORD","REQUIRED_MARK","SPECIAL","EOF_STATEMENT","WSL","STRING"];p.VOCABULARY=new Ne.VocabularyImpl(p._LITERAL_NAMES,p._SYMBOLIC_NAMES,[]);p._serializedATN=`\uC91D\uCABA\u058D\uAFBA\u4F53\u0607\uEA8B\uC241X\b					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r		\x07$
\f'\v\x07\x07\b\b		

9

\r

:\v\v\f\f@
\f\r\f\fA\r\rG
\rH\x07P
\fS\vW
Q\x07	\v\r\x07\b	
\v\f\x1B\r\x07C\\aac|2;C\\aac|\f$%'(,-/1<<>B]]_\`bb}\x80\v\f""^^[\x07	\v\r\x1B!\x07(	,\v.\r1358<?C\x1BFL \x07) !%	"$	#"$'%#%&&'%())**+\b+\b,-\x07&-
./\x07&/0\x07&0\f12\x07.234\x07*456\x07+679	879::8:;;<=\x07#=>@	?>@AA?ABBCD\x07=DEG	FEGHHFHIIJJK\bKLVMWNP\vONPSQRQORTSQTU
UWVMVQW	%:AHQV	\b`;var V=require("antlr4ts/atn/ATN.js"),Oe=require("antlr4ts/atn/ATNDeserializer.js"),De=require("antlr4ts/FailedPredicateException.js"),be=require("antlr4ts/NoViableAltException.js"),ke=require("antlr4ts/Parser.js"),y=require("antlr4ts/ParserRuleContext.js"),Ue=require("antlr4ts/atn/ParserATNSimulator.js"),E=require("antlr4ts/RecognitionException.js"),ve=require("antlr4ts/Token.js"),Be=require("antlr4ts/VocabularyImpl.js"),Qe=N(require("antlr4ts/misc/Utils.js"),1),i=class t extends ke.Parser{get vocabulary(){return t.VOCABULARY}get grammarFileName(){return"QueryParser.g4"}get ruleNames(){return t.ruleNames}get serializedATN(){return t._serializedATN}createFailedPredicateException(e,x){return new De.FailedPredicateException(this,e,x)}constructor(e){super(e),this._interp=new Ue.ParserATNSimulator(t._ATN,this)}input(){let e=new de(this._ctx,this.state);this.enterRule(e,0,t.RULE_input);let x;try{this.enterOuterAlt(e,1),this.state=22,this.query(),this.state=24,this._errHandler.sync(this),x=this._input.LA(1),x===t.EOF_STATEMENT&&(this.state=23,this.match(t.EOF_STATEMENT)),this.state=26,this.match(t.EOF)}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}query(){let e=new z(this._ctx,this.state);this.enterRule(e,2,t.RULE_query);let x;try{this.enterOuterAlt(e,1);{this.state=29,this._errHandler.sync(this),x=this._input.LA(1);do this.state=28,this.ignored(),this.state=31,this._errHandler.sync(this),x=this._input.LA(1);while(!(x&-32)&&1<<x&(1<<t.ID|1<<t.COMMA|1<<t.OB|1<<t.CB|1<<t.WORD|1<<t.REQUIRED_MARK|1<<t.SPECIAL|1<<t.STRING));for(this.state=42,this._errHandler.sync(this),x=this._input.LA(1);x===t.SINGULAR_PARAM_MARK||x===t.PLURAL_PARAM_MARK;){for(this.state=33,this.param(),this.state=37,this._errHandler.sync(this),x=this._input.LA(1);!(x&-32)&&1<<x&(1<<t.ID|1<<t.COMMA|1<<t.OB|1<<t.CB|1<<t.WORD|1<<t.REQUIRED_MARK|1<<t.SPECIAL|1<<t.STRING);)this.state=34,this.ignored(),this.state=39,this._errHandler.sync(this),x=this._input.LA(1);this.state=44,this._errHandler.sync(this),x=this._input.LA(1)}}}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}param(){let e=new O(this._ctx,this.state);this.enterRule(e,4,t.RULE_param);try{switch(this.state=49,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,4,this._ctx)){case 1:this.enterOuterAlt(e,1),this.state=45,this.pickParam();break;case 2:this.enterOuterAlt(e,2),this.state=46,this.arrayPickParam();break;case 3:this.enterOuterAlt(e,3),this.state=47,this.scalarParam();break;case 4:this.enterOuterAlt(e,4),this.state=48,this.arrayParam();break}}catch(x){if(x instanceof E.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}ignored(){let e=new D(this._ctx,this.state);this.enterRule(e,6,t.RULE_ignored);let x;try{let r;this.enterOuterAlt(e,1);{this.state=52,this._errHandler.sync(this),r=1;do{switch(r){case 1:this.state=51,x=this._input.LA(1),!(x&-32)&&1<<x&(1<<t.ID|1<<t.COMMA|1<<t.OB|1<<t.CB|1<<t.WORD|1<<t.REQUIRED_MARK|1<<t.SPECIAL|1<<t.STRING)?(this._input.LA(1)===ve.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):this._errHandler.recoverInline(this);break;default:throw new be.NoViableAltException(this)}this.state=54,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,5,this._ctx)}while(r!==2&&r!==V.ATN.INVALID_ALT_NUMBER)}}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}scalarParam(){let e=new j(this._ctx,this.state);this.enterRule(e,8,t.RULE_scalarParam);try{this.enterOuterAlt(e,1),this.state=56,this.match(t.SINGULAR_PARAM_MARK),this.state=57,this.scalarParamName()}catch(x){if(x instanceof E.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}pickParam(){let e=new J(this._ctx,this.state);this.enterRule(e,10,t.RULE_pickParam);let x;try{let r;this.enterOuterAlt(e,1);{for(this.state=59,this.match(t.SINGULAR_PARAM_MARK),this.state=60,this.paramName(),this.state=61,this.match(t.OB),this.state=62,this.pickKey(),this.state=67,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,6,this._ctx);r!==2&&r!==V.ATN.INVALID_ALT_NUMBER;)r===1&&(this.state=63,this.match(t.COMMA),this.state=64,this.pickKey()),this.state=69,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,6,this._ctx);this.state=71,this._errHandler.sync(this),x=this._input.LA(1),x===t.COMMA&&(this.state=70,this.match(t.COMMA)),this.state=73,this.match(t.CB)}}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}arrayPickParam(){let e=new Z(this._ctx,this.state);this.enterRule(e,12,t.RULE_arrayPickParam);let x;try{let r;this.enterOuterAlt(e,1);{for(this.state=75,this.match(t.PLURAL_PARAM_MARK),this.state=76,this.paramName(),this.state=77,this.match(t.OB),this.state=78,this.pickKey(),this.state=83,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,8,this._ctx);r!==2&&r!==V.ATN.INVALID_ALT_NUMBER;)r===1&&(this.state=79,this.match(t.COMMA),this.state=80,this.pickKey()),this.state=85,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,8,this._ctx);this.state=87,this._errHandler.sync(this),x=this._input.LA(1),x===t.COMMA&&(this.state=86,this.match(t.COMMA)),this.state=89,this.match(t.CB)}}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}arrayParam(){let e=new X(this._ctx,this.state);this.enterRule(e,14,t.RULE_arrayParam);try{this.enterOuterAlt(e,1),this.state=91,this.match(t.PLURAL_PARAM_MARK),this.state=92,this.scalarParamName()}catch(x){if(x instanceof E.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}scalarParamName(){let e=new b(this._ctx,this.state);this.enterRule(e,16,t.RULE_scalarParamName);try{switch(this.enterOuterAlt(e,1),this.state=94,this.match(t.ID),this.state=96,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,10,this._ctx)){case 1:this.state=95,this.match(t.REQUIRED_MARK);break}}catch(x){if(x instanceof E.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}paramName(){let e=new k(this._ctx,this.state);this.enterRule(e,18,t.RULE_paramName);try{this.enterOuterAlt(e,1),this.state=98,this.match(t.ID)}catch(x){if(x instanceof E.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}pickKey(){let e=new g(this._ctx,this.state);this.enterRule(e,20,t.RULE_pickKey);let x;try{this.enterOuterAlt(e,1),this.state=100,this.match(t.ID),this.state=102,this._errHandler.sync(this),x=this._input.LA(1),x===t.REQUIRED_MARK&&(this.state=101,this.match(t.REQUIRED_MARK))}catch(r){if(r instanceof E.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}static get _ATN(){return t.__ATN||(t.__ATN=new Oe.ATNDeserializer().deserialize(Qe.toCharArray(t._serializedATN))),t.__ATN}};i.ID=1;i.SINGULAR_PARAM_MARK=2;i.PLURAL_PARAM_MARK=3;i.COMMA=4;i.OB=5;i.CB=6;i.WORD=7;i.REQUIRED_MARK=8;i.SPECIAL=9;i.EOF_STATEMENT=10;i.WSL=11;i.STRING=12;i.RULE_input=0;i.RULE_query=1;i.RULE_param=2;i.RULE_ignored=3;i.RULE_scalarParam=4;i.RULE_pickParam=5;i.RULE_arrayPickParam=6;i.RULE_arrayParam=7;i.RULE_scalarParamName=8;i.RULE_paramName=9;i.RULE_pickKey=10;i.ruleNames=["input","query","param","ignored","scalarParam","pickParam","arrayPickParam","arrayParam","scalarParamName","paramName","pickKey"];i._LITERAL_NAMES=[void 0,void 0,"'$'","'$$'","','","'('","')'",void 0,"'!'",void 0,"';'"];i._SYMBOLIC_NAMES=[void 0,"ID","SINGULAR_PARAM_MARK","PLURAL_PARAM_MARK","COMMA","OB","CB","WORD","REQUIRED_MARK","SPECIAL","EOF_STATEMENT","WSL","STRING"];i.VOCABULARY=new Be.VocabularyImpl(i._LITERAL_NAMES,i._SYMBOLIC_NAMES,[]);i._serializedATN=`\uC91D\uCABA\u058D\uAFBA\u4F53\u0607\uEA8B\uC241k					\x07	\x07\b	\b			
	
\v	\v\f	\f\x1B
 
\r!\x07&
\f)\v\x07+
\f.\v4
7
\r8\x07\x07\x07\x07\x07\x07\x07\x07D
\x07\f\x07\x07G\v\x07\x07\x07J
\x07\x07\x07\b\b\b\b\b\b\x07\bT
\b\f\b\bW\v\b\b\bZ
\b\b\b			


c

\v\v\f\f\fi
\f\f\r\b
\f\vm3\b6
:\f=M]\`df\x1B\x07\f\x1B\x1B\x07 \b !!!"",#'$&\b%$&)'%'((+)'*#+.,*,--.,/4\f\x0704\b14
24	3/3031324\x0757	657886899	:;\x07;<
<\v=>\x07>?\v?@\x07\x07@E\fAB\x07BD\fCADGECEFFIGEHJ\x07IHIJJKKL\x07\bL\rMN\x07NO\vOP\x07\x07PU\fQR\x07RT\fSQTWUSUVVYWUXZ\x07YXYZZ[[\\\x07\b\\]^\x07^_
_\`b\x07ac\x07
babccde\x07efh\x07gi\x07
hghii!',38EIUYbh`;var de=class extends y.ParserRuleContext{query(){return this.getRuleContext(0,z)}EOF(){return this.getToken(i.EOF,0)}EOF_STATEMENT(){return this.tryGetToken(i.EOF_STATEMENT,0)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_input}enterRule(e){e.enterInput&&e.enterInput(this)}exitRule(e){e.exitInput&&e.exitInput(this)}accept(e){return e.visitInput?e.visitInput(this):e.visitChildren(this)}},z=class extends y.ParserRuleContext{ignored(e){return e===void 0?this.getRuleContexts(D):this.getRuleContext(e,D)}param(e){return e===void 0?this.getRuleContexts(O):this.getRuleContext(e,O)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_query}enterRule(e){e.enterQuery&&e.enterQuery(this)}exitRule(e){e.exitQuery&&e.exitQuery(this)}accept(e){return e.visitQuery?e.visitQuery(this):e.visitChildren(this)}},O=class extends y.ParserRuleContext{pickParam(){return this.tryGetRuleContext(0,J)}arrayPickParam(){return this.tryGetRuleContext(0,Z)}scalarParam(){return this.tryGetRuleContext(0,j)}arrayParam(){return this.tryGetRuleContext(0,X)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_param}enterRule(e){e.enterParam&&e.enterParam(this)}exitRule(e){e.exitParam&&e.exitParam(this)}accept(e){return e.visitParam?e.visitParam(this):e.visitChildren(this)}},D=class extends y.ParserRuleContext{ID(e){return e===void 0?this.getTokens(i.ID):this.getToken(i.ID,e)}WORD(e){return e===void 0?this.getTokens(i.WORD):this.getToken(i.WORD,e)}STRING(e){return e===void 0?this.getTokens(i.STRING):this.getToken(i.STRING,e)}COMMA(e){return e===void 0?this.getTokens(i.COMMA):this.getToken(i.COMMA,e)}OB(e){return e===void 0?this.getTokens(i.OB):this.getToken(i.OB,e)}CB(e){return e===void 0?this.getTokens(i.CB):this.getToken(i.CB,e)}SPECIAL(e){return e===void 0?this.getTokens(i.SPECIAL):this.getToken(i.SPECIAL,e)}REQUIRED_MARK(e){return e===void 0?this.getTokens(i.REQUIRED_MARK):this.getToken(i.REQUIRED_MARK,e)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_ignored}enterRule(e){e.enterIgnored&&e.enterIgnored(this)}exitRule(e){e.exitIgnored&&e.exitIgnored(this)}accept(e){return e.visitIgnored?e.visitIgnored(this):e.visitChildren(this)}},j=class extends y.ParserRuleContext{SINGULAR_PARAM_MARK(){return this.getToken(i.SINGULAR_PARAM_MARK,0)}scalarParamName(){return this.getRuleContext(0,b)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_scalarParam}enterRule(e){e.enterScalarParam&&e.enterScalarParam(this)}exitRule(e){e.exitScalarParam&&e.exitScalarParam(this)}accept(e){return e.visitScalarParam?e.visitScalarParam(this):e.visitChildren(this)}},J=class extends y.ParserRuleContext{SINGULAR_PARAM_MARK(){return this.getToken(i.SINGULAR_PARAM_MARK,0)}paramName(){return this.getRuleContext(0,k)}OB(){return this.getToken(i.OB,0)}pickKey(e){return e===void 0?this.getRuleContexts(g):this.getRuleContext(e,g)}CB(){return this.getToken(i.CB,0)}COMMA(e){return e===void 0?this.getTokens(i.COMMA):this.getToken(i.COMMA,e)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_pickParam}enterRule(e){e.enterPickParam&&e.enterPickParam(this)}exitRule(e){e.exitPickParam&&e.exitPickParam(this)}accept(e){return e.visitPickParam?e.visitPickParam(this):e.visitChildren(this)}},Z=class extends y.ParserRuleContext{PLURAL_PARAM_MARK(){return this.getToken(i.PLURAL_PARAM_MARK,0)}paramName(){return this.getRuleContext(0,k)}OB(){return this.getToken(i.OB,0)}pickKey(e){return e===void 0?this.getRuleContexts(g):this.getRuleContext(e,g)}CB(){return this.getToken(i.CB,0)}COMMA(e){return e===void 0?this.getTokens(i.COMMA):this.getToken(i.COMMA,e)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_arrayPickParam}enterRule(e){e.enterArrayPickParam&&e.enterArrayPickParam(this)}exitRule(e){e.exitArrayPickParam&&e.exitArrayPickParam(this)}accept(e){return e.visitArrayPickParam?e.visitArrayPickParam(this):e.visitChildren(this)}},X=class extends y.ParserRuleContext{PLURAL_PARAM_MARK(){return this.getToken(i.PLURAL_PARAM_MARK,0)}scalarParamName(){return this.getRuleContext(0,b)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_arrayParam}enterRule(e){e.enterArrayParam&&e.enterArrayParam(this)}exitRule(e){e.exitArrayParam&&e.exitArrayParam(this)}accept(e){return e.visitArrayParam?e.visitArrayParam(this):e.visitChildren(this)}},b=class extends y.ParserRuleContext{ID(){return this.getToken(i.ID,0)}REQUIRED_MARK(){return this.tryGetToken(i.REQUIRED_MARK,0)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_scalarParamName}enterRule(e){e.enterScalarParamName&&e.enterScalarParamName(this)}exitRule(e){e.exitScalarParamName&&e.exitScalarParamName(this)}accept(e){return e.visitScalarParamName?e.visitScalarParamName(this):e.visitChildren(this)}},k=class extends y.ParserRuleContext{ID(){return this.getToken(i.ID,0)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_paramName}enterRule(e){e.enterParamName&&e.enterParamName(this)}exitRule(e){e.exitParamName&&e.exitParamName(this)}accept(e){return e.visitParamName?e.visitParamName(this):e.visitChildren(this)}},g=class extends y.ParserRuleContext{ID(){return this.getToken(i.ID,0)}REQUIRED_MARK(){return this.tryGetToken(i.REQUIRED_MARK,0)}constructor(e,x){super(e,x)}get ruleIndex(){return i.RULE_pickKey}enterRule(e){e.enterPickKey&&e.enterPickKey(this)}exitRule(e){e.exitPickKey&&e.exitPickKey(this)}accept(e){return e.visitPickKey?e.visitPickKey(this):e.visitChildren(this)}};var ut=N(require("chalk"),1),pe;(function(t){t[t.ParamNeverUsed=0]="ParamNeverUsed"})(pe||(pe={}));var Re;(function(t){t[t.ParseError=0]="ParseError"})(Re||(Re={}));var ee;(function(t){t[t.Info=0]="Info",t[t.Warning=1]="Warning",t[t.Error=2]="Error"})(ee||(ee={}));var U=class{constructor(){this.parseEvents=[]}logEvent(e){this.parseEvents.push(e)}syntaxError(e,x,r,n,h,c){this.logEvent({type:ee.Error,critical:!0,message:{type:Re.ParseError,text:`Parse error: ${h}`},location:{a:x==null?void 0:x.startIndex,b:x==null?void 0:x.stopIndex,line:r,col:n}})}};var we=require("antlr4ts/misc/index.js"),_;(function(t){t.Scalar="scalar",t.Object="object",t.ScalarArray="scalar_array",t.ObjectArray="object_array"})(_||(_={}));function ht(t){if(!t)throw new Error("Assertion Failed")}var fe=class{constructor(e,x){this.query={},this.currentParam={},this.currentSelection={},this.query.name=e,this.logger=x}enterQuery(e){let{inputStream:x}=e.start,r=e.stop.stopIndex,n=new we.Interval(0,r),h=x.getText(n);this.query={name:this.query.name,text:h,params:[]}}enterParamName(e){this.currentParam={name:e.text,selection:void 0}}enterScalarParamName(e){let x=!!e.REQUIRED_MARK(),r=e.ID().text;this.currentParam={name:r,required:x}}exitParam(e){let x={a:e.start.startIndex,b:e.stop.stopIndex,line:e.start.line,col:e.start.charPositionInLine};this.currentParam.location=x,this.currentParam.selection=this.currentSelection,this.query.params.push(this.currentParam),this.currentSelection={},this.currentParam={}}enterScalarParam(){this.currentSelection={type:_.Scalar}}enterPickParam(){this.currentSelection={type:_.Object,keys:[]}}enterArrayPickParam(){this.currentSelection={type:_.ObjectArray,keys:[]}}enterArrayParam(){this.currentSelection={type:_.ScalarArray}}enterPickKey(e){ht("keys"in this.currentSelection);let x=!!e.REQUIRED_MARK(),r=e.ID().text;this.currentSelection.keys.push({name:r,required:x})}};function ot(t,e="query"){let x=new U,r=te.CharStreams.fromString(t),n=new p(r);n.removeErrorListeners(),n.addErrorListener(x);let h=new te.CommonTokenStream(n),c=new i(h);c.removeErrorListeners(),c.addErrorListener(x);let a=c.input(),u=new fe(e,x);return Fe.ParseTreeWalker.DEFAULT.walk(u,a),{query:u.query,events:x.parseEvents}}var Ae=ot;var Ze=require("antlr4ts"),lt=require("antlr4ts/tree/ParseTreeWalker.js");var He=require("antlr4ts/atn/ATNDeserializer.js"),Ke=require("antlr4ts/Lexer.js"),Ge=require("antlr4ts/atn/LexerATNSimulator.js"),qe=require("antlr4ts/VocabularyImpl.js"),We=N(require("antlr4ts/misc/Utils.js"),1),l=class t extends Ke.Lexer{get vocabulary(){return t.VOCABULARY}constructor(e){super(e),this._interp=new Ge.LexerATNSimulator(t._ATN,this)}get grammarFileName(){return"SQLLexer.g4"}get ruleNames(){return t.ruleNames}get serializedATN(){return t._serializedATN}get channelNames(){return t.channelNames}get modeNames(){return t.modeNames}static get _ATN(){return t.__ATN||(t.__ATN=new He.ATNDeserializer().deserialize(We.toCharArray(t._serializedATN))),t.__ATN}};l.ID=1;l.LINE_COMMENT=2;l.OPEN_COMMENT=3;l.S_REQUIRED_MARK=4;l.WORD=5;l.EOF_STATEMENT=6;l.WSL=7;l.STRING=8;l.DOLLAR_STRING=9;l.PARAM_MARK=10;l.WS=11;l.TRANSFORM_ARROW=12;l.SPREAD=13;l.NAME_TAG=14;l.TYPE_TAG=15;l.OB=16;l.CB=17;l.COMMA=18;l.C_REQUIRED_MARK=19;l.ANY=20;l.CLOSE_COMMENT=21;l.DOLLAR=22;l.CAST=23;l.COMMENT=1;l.channelNames=["DEFAULT_TOKEN_CHANNEL","HIDDEN"];l.modeNames=["DEFAULT_MODE","COMMENT"];l.ruleNames=["QUOT","ID","LINE_COMMENT","OPEN_COMMENT","SID","S_REQUIRED_MARK","WORD","SPECIAL","DOLLAR","EOF_STATEMENT","WSL","STRING","DOLLAR_STRING","PARAM_MARK","CAST","CID","WS","TRANSFORM_ARROW","SPREAD","NAME_TAG","TYPE_TAG","OB","CB","COMMA","C_REQUIRED_MARK","ANY","CLOSE_COMMENT"];l._LITERAL_NAMES=[void 0,void 0,void 0,"'/*'",void 0,void 0,"';'",void 0,void 0,void 0,"':'",void 0,"'->'","'...'","'@name'","'@param'","'('","')'","','",void 0,void 0,"'*/'","'$'","'::'"];l._SYMBOLIC_NAMES=[void 0,"ID","LINE_COMMENT","OPEN_COMMENT","S_REQUIRED_MARK","WORD","EOF_STATEMENT","WSL","STRING","DOLLAR_STRING","PARAM_MARK","WS","TRANSFORM_ARROW","SPREAD","NAME_TAG","TYPE_TAG","OB","CB","COMMA","C_REQUIRED_MARK","ANY","CLOSE_COMMENT","DOLLAR","CAST"];l.VOCABULARY=new qe.VocabularyImpl(l._LITERAL_NAMES,l._SYMBOLIC_NAMES,[]);l._serializedATN=`\uC91D\uCABA\u058D\uAFBA\u4F53\u0607\uEA8B\uC241\xCA\b\b					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r													\x1B	\x1B	\x07?
\fB\v\x07H
\fK\vN
\x07\x07\b\b^
\b\r\b\b_		c
	\r		d		



\v\v\f\fp
\f\r\f\fq\f\f\r\r\r\x07\ry
\r\f\r\r|\v\r\r\r\r\x80
\r\x84
\x07\x88
\f\x8B\v\x8F
\x9F
\r\xA0\x1B\x1B\xC2
\x1B\r\x1B\x1B\xC3z\xC3\b
\f\x07\b	
\v\f "$\r&(*,.02468\bC\\aac|2;C\\aac|\f\f
$%'(*1>B]]_\`bb}\x80\v\f""^^\xD3\b
\f "$&(*,.02468:<\bC
Q\fVZ]bhlou\x81\x92 \x94"\x99$\x9E&\xA4(\xA7*\xAB,\xB1.\xB80\xBA2\xBC4\xBE6\xC18\xC5:;\x07);<@	=?	>=?B@>@AA\x07B@CD\x07/DE\x07/EIFH
GFHKIGIJJMKILN\x07MLMNNOOP\x07\fP	QR\x071RS\x07,STTU\bU\vVWWXXY\bY\rZ[\x07#[\\^	]\\^__]_\`\`ac	bacddbdeeffg\b	ghi\x07&ijjk\b
klm\x07=mnp	onpqqoqrrsst\b\ftu\x7Fv\x80wy\vxwy|z{zx{}|z}~
\x07~\x80\x7Fv\x7Fz\x80\x1B\x81\x83
\x82\x84\b\x83\x82\x83\x84\x84\x85\x85\x89
\x86\x88\v\x87\x86\x88\x8B\x89\x87\x89\x8A\x8A\x8C\x8B\x89\x8C\x8E
\x8D\x8F\b\x8E\x8D\x8E\x8F\x8F\x90\x90\x91
\x91\x92\x93\x07<\x93\x94\x95\x07<\x95\x96\x07<\x96\x97\x97\x98\b\x98!\x99\x9A\x9A\x9B\x9B\x9C\b\x9C#\x9D\x9F	\x9E\x9D\x9F\xA0\xA0\x9E\xA0\xA1\xA1\xA2\xA2\xA3\b\xA3%\xA4\xA5\x07/\xA5\xA6\x07@\xA6'\xA7\xA8\x070\xA8\xA9\x070\xA9\xAA\x070\xAA)\xAB\xAC\x07B\xAC\xAD\x07p\xAD\xAE\x07c\xAE\xAF\x07o\xAF\xB0\x07g\xB0+\xB1\xB2\x07B\xB2\xB3\x07r\xB3\xB4\x07c\xB4\xB5\x07t\xB5\xB6\x07c\xB6\xB7\x07o\xB7-\xB8\xB9\x07*\xB9/\xBA\xBB\x07+\xBB1\xBC\xBD\x07.\xBD3\xBE\xBF\x07#\xBF5\xC0\xC2\v\xC1\xC0\xC2\xC3\xC3\xC4\xC3\xC1\xC47\xC5\xC6\x07,\xC6\xC7\x071\xC7\xC8\xC8\xC9\b\xC99@IM_dqz\x7F\x83\x89\x8E\xA0\xC3\x07		\x07\b`;var Ee=require("antlr4ts/atn/ATN.js"),$e=require("antlr4ts/atn/ATNDeserializer.js"),Ye=require("antlr4ts/FailedPredicateException.js"),Ve=require("antlr4ts/Parser.js"),f=require("antlr4ts/ParserRuleContext.js"),ze=require("antlr4ts/atn/ParserATNSimulator.js"),R=require("antlr4ts/RecognitionException.js"),ye=require("antlr4ts/Token.js"),je=require("antlr4ts/VocabularyImpl.js"),Je=N(require("antlr4ts/misc/Utils.js"),1),s=class t extends Ve.Parser{get vocabulary(){return t.VOCABULARY}get grammarFileName(){return"SQLParser.g4"}get ruleNames(){return t.ruleNames}get serializedATN(){return t._serializedATN}createFailedPredicateException(e,x){return new Ye.FailedPredicateException(this,e,x)}constructor(e){super(e),this._interp=new ze.ParserATNSimulator(t._ATN,this)}input(){let e=new _e(this._ctx,this.state);this.enterRule(e,0,t.RULE_input);let x;try{let r;this.enterOuterAlt(e,1);{this.state=47,this._errHandler.sync(this),x=this._input.LA(1);do{{for(this.state=43,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,0,this._ctx);r!==2&&r!==Ee.ATN.INVALID_ALT_NUMBER;)r===1&&(this.state=40,this.ignoredComment()),this.state=45,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,0,this._ctx);this.state=46,this.query()}this.state=49,this._errHandler.sync(this),x=this._input.LA(1)}while(x===t.OPEN_COMMENT);this.state=51,this.match(t.EOF)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}query(){let e=new v(this._ctx,this.state);this.enterRule(e,2,t.RULE_query);try{this.enterOuterAlt(e,1),this.state=53,this.queryDef(),this.state=54,this.statement()}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}queryDef(){let e=new xe(this._ctx,this.state);this.enterRule(e,4,t.RULE_queryDef);let x;try{this.enterOuterAlt(e,1);{for(this.state=56,this.match(t.OPEN_COMMENT),this.state=57,this.nameTag(),this.state=61,this._errHandler.sync(this),x=this._input.LA(1);x===t.TYPE_TAG;)this.state=58,this.paramTag(),this.state=63,this._errHandler.sync(this),x=this._input.LA(1);this.state=64,this.match(t.CLOSE_COMMENT)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}ignoredComment(){let e=new S(this._ctx,this.state);this.enterRule(e,6,t.RULE_ignoredComment);let x;try{this.enterOuterAlt(e,1);{for(this.state=66,this.match(t.OPEN_COMMENT),this.state=70,this._errHandler.sync(this),x=this._input.LA(1);!(x&-32)&&1<<x&(1<<t.ID|1<<t.LINE_COMMENT|1<<t.OPEN_COMMENT|1<<t.S_REQUIRED_MARK|1<<t.WORD|1<<t.EOF_STATEMENT|1<<t.WSL|1<<t.STRING|1<<t.DOLLAR_STRING|1<<t.PARAM_MARK|1<<t.WS|1<<t.TRANSFORM_ARROW|1<<t.SPREAD|1<<t.NAME_TAG|1<<t.TYPE_TAG|1<<t.OB|1<<t.CB|1<<t.COMMA|1<<t.C_REQUIRED_MARK|1<<t.ANY|1<<t.DOLLAR|1<<t.CAST);)this.state=67,x=this._input.LA(1),x<=0||x===t.CLOSE_COMMENT?this._errHandler.recoverInline(this):(this._input.LA(1)===ye.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()),this.state=72,this._errHandler.sync(this),x=this._input.LA(1);this.state=73,this.match(t.CLOSE_COMMENT)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}statement(){let e=new re(this._ctx,this.state);this.enterRule(e,8,t.RULE_statement);try{this.enterOuterAlt(e,1),this.state=75,this.statementBody(),this.state=76,this.match(t.EOF_STATEMENT)}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}statementBody(){let e=new se(this._ctx,this.state);this.enterRule(e,10,t.RULE_statementBody);let x;try{for(this.enterOuterAlt(e,1),this.state=85,this._errHandler.sync(this),x=this._input.LA(1);!(x&-32)&&1<<x&(1<<t.ID|1<<t.LINE_COMMENT|1<<t.OPEN_COMMENT|1<<t.S_REQUIRED_MARK|1<<t.WORD|1<<t.STRING|1<<t.DOLLAR_STRING|1<<t.PARAM_MARK);){switch(this.state=83,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,4,this._ctx)){case 1:this.state=78,this.match(t.LINE_COMMENT);break;case 2:this.state=79,this.ignoredComment();break;case 3:this.state=80,this.param();break;case 4:this.state=81,this.word();break;case 5:this.state=82,this.range();break}this.state=87,this._errHandler.sync(this),x=this._input.LA(1)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}word(){let e=new M(this._ctx,this.state);this.enterRule(e,12,t.RULE_word);let x;try{this.enterOuterAlt(e,1),this.state=88,x=this._input.LA(1),!(x&-32)&&1<<x&(1<<t.ID|1<<t.S_REQUIRED_MARK|1<<t.WORD|1<<t.STRING|1<<t.DOLLAR_STRING)?(this._input.LA(1)===ye.Token.EOF&&(this.matchedEOF=!0),this._errHandler.reportMatch(this),this.consume()):this._errHandler.recoverInline(this)}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}range(){let e=new B(this._ctx,this.state);this.enterRule(e,14,t.RULE_range);try{this.enterOuterAlt(e,1),this.state=90,this.match(t.PARAM_MARK),this.state=91,this.word()}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}param(){let e=new Q(this._ctx,this.state);this.enterRule(e,16,t.RULE_param);try{this.enterOuterAlt(e,1),this.state=93,this.match(t.PARAM_MARK),this.state=94,this.paramId()}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}paramId(){let e=new ie(this._ctx,this.state);this.enterRule(e,18,t.RULE_paramId);try{switch(this.enterOuterAlt(e,1),this.state=96,this.match(t.ID),this.state=98,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,6,this._ctx)){case 1:this.state=97,this.match(t.S_REQUIRED_MARK);break}}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}nameTag(){let e=new ne(this._ctx,this.state);this.enterRule(e,20,t.RULE_nameTag);try{this.enterOuterAlt(e,1),this.state=100,this.match(t.NAME_TAG),this.state=101,this.queryName()}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}paramTag(){let e=new F(this._ctx,this.state);this.enterRule(e,22,t.RULE_paramTag);try{this.enterOuterAlt(e,1),this.state=103,this.match(t.TYPE_TAG),this.state=104,this.paramName(),this.state=105,this.paramTransform()}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}paramTransform(){let e=new ae(this._ctx,this.state);this.enterRule(e,24,t.RULE_paramTransform);try{this.enterOuterAlt(e,1),this.state=107,this.match(t.TRANSFORM_ARROW),this.state=108,this.transformRule()}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}transformRule(){let e=new ue(this._ctx,this.state);this.enterRule(e,26,t.RULE_transformRule);try{switch(this.state=113,this._errHandler.sync(this),this.interpreter.adaptivePredict(this._input,7,this._ctx)){case 1:this.enterOuterAlt(e,1),this.state=110,this.spreadTransform();break;case 2:this.enterOuterAlt(e,2),this.state=111,this.pickTransform();break;case 3:this.enterOuterAlt(e,3),this.state=112,this.spreadPickTransform();break}}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}spreadTransform(){let e=new he(this._ctx,this.state);this.enterRule(e,28,t.RULE_spreadTransform);try{this.enterOuterAlt(e,1),this.state=115,this.match(t.OB),this.state=116,this.match(t.SPREAD),this.state=117,this.match(t.CB)}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}pickTransform(){let e=new w(this._ctx,this.state);this.enterRule(e,30,t.RULE_pickTransform);let x;try{let r;this.enterOuterAlt(e,1);{for(this.state=119,this.match(t.OB),this.state=120,this.key(),this.state=125,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,8,this._ctx);r!==2&&r!==Ee.ATN.INVALID_ALT_NUMBER;)r===1&&(this.state=121,this.match(t.COMMA),this.state=122,this.key()),this.state=127,this._errHandler.sync(this),r=this.interpreter.adaptivePredict(this._input,8,this._ctx);this.state=129,this._errHandler.sync(this),x=this._input.LA(1),x===t.COMMA&&(this.state=128,this.match(t.COMMA)),this.state=131,this.match(t.CB)}}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}spreadPickTransform(){let e=new oe(this._ctx,this.state);this.enterRule(e,32,t.RULE_spreadPickTransform);try{this.enterOuterAlt(e,1),this.state=133,this.match(t.OB),this.state=134,this.pickTransform(),this.state=135,this.match(t.SPREAD),this.state=136,this.match(t.CB)}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}key(){let e=new H(this._ctx,this.state);this.enterRule(e,34,t.RULE_key);let x;try{this.enterOuterAlt(e,1),this.state=138,this.match(t.ID),this.state=140,this._errHandler.sync(this),x=this._input.LA(1),x===t.C_REQUIRED_MARK&&(this.state=139,this.match(t.C_REQUIRED_MARK))}catch(r){if(r instanceof R.RecognitionException)e.exception=r,this._errHandler.reportError(this,r),this._errHandler.recover(this,r);else throw r}finally{this.exitRule()}return e}queryName(){let e=new ce(this._ctx,this.state);this.enterRule(e,36,t.RULE_queryName);try{this.enterOuterAlt(e,1),this.state=142,this.match(t.ID)}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}paramName(){let e=new le(this._ctx,this.state);this.enterRule(e,38,t.RULE_paramName);try{this.enterOuterAlt(e,1),this.state=144,this.match(t.ID)}catch(x){if(x instanceof R.RecognitionException)e.exception=x,this._errHandler.reportError(this,x),this._errHandler.recover(this,x);else throw x}finally{this.exitRule()}return e}static get _ATN(){return t.__ATN||(t.__ATN=new $e.ATNDeserializer().deserialize(Je.toCharArray(t._serializedATN))),t.__ATN}};s.ID=1;s.LINE_COMMENT=2;s.OPEN_COMMENT=3;s.S_REQUIRED_MARK=4;s.WORD=5;s.EOF_STATEMENT=6;s.WSL=7;s.STRING=8;s.DOLLAR_STRING=9;s.PARAM_MARK=10;s.WS=11;s.TRANSFORM_ARROW=12;s.SPREAD=13;s.NAME_TAG=14;s.TYPE_TAG=15;s.OB=16;s.CB=17;s.COMMA=18;s.C_REQUIRED_MARK=19;s.ANY=20;s.CLOSE_COMMENT=21;s.DOLLAR=22;s.CAST=23;s.RULE_input=0;s.RULE_query=1;s.RULE_queryDef=2;s.RULE_ignoredComment=3;s.RULE_statement=4;s.RULE_statementBody=5;s.RULE_word=6;s.RULE_range=7;s.RULE_param=8;s.RULE_paramId=9;s.RULE_nameTag=10;s.RULE_paramTag=11;s.RULE_paramTransform=12;s.RULE_transformRule=13;s.RULE_spreadTransform=14;s.RULE_pickTransform=15;s.RULE_spreadPickTransform=16;s.RULE_key=17;s.RULE_queryName=18;s.RULE_paramName=19;s.ruleNames=["input","query","queryDef","ignoredComment","statement","statementBody","word","range","param","paramId","nameTag","paramTag","paramTransform","transformRule","spreadTransform","pickTransform","spreadPickTransform","key","queryName","paramName"];s._LITERAL_NAMES=[void 0,void 0,void 0,"'/*'",void 0,void 0,"';'",void 0,void 0,void 0,"':'",void 0,"'->'","'...'","'@name'","'@param'","'('","')'","','",void 0,void 0,"'*/'","'$'","'::'"];s._SYMBOLIC_NAMES=[void 0,"ID","LINE_COMMENT","OPEN_COMMENT","S_REQUIRED_MARK","WORD","EOF_STATEMENT","WSL","STRING","DOLLAR_STRING","PARAM_MARK","WS","TRANSFORM_ARROW","SPREAD","NAME_TAG","TYPE_TAG","OB","CB","COMMA","C_REQUIRED_MARK","ANY","CLOSE_COMMENT","DOLLAR","CAST"];s.VOCABULARY=new je.VocabularyImpl(s._LITERAL_NAMES,s._SYMBOLIC_NAMES,[]);s._serializedATN=`\uC91D\uCABA\u058D\uAFBA\u4F53\u0607\uEA8B\uC241\x95					\x07	\x07\b	\b			
	
\v	\v\f	\f\r	\r								\x07,
\f/\v2
\r3\x07>
\fA\v\x07G
\fJ\v\x07\x07\x07\x07\x07\x07\x07V
\x07\f\x07\x07Y\v\x07\b\b			


\v\v\ve
\v\f\f\f\r\r\r\rt
\x07~
\f\x81\v\x84
\x8F
\b
\f "$&(\x07
\v\x8F17:\bD
M\fWZ\\_bfimsu y"\x87$\x8C&\x90(\x92*,\b+*,/-+-..0/-021-2331344556\x0767889
9:;\x07;?\f<>\r=<>A?=?@@BA?BC\x07C\x07DH\x07EG
FEGJHFHIIKJHKL\x07L	MN\f\x07NO\x07\bO\vPV\x07QV\bRV
SV\bTV	UPUQURUSUTVYWUWXX\rYWZ[	[\\]\x07\f]^\b^_\`\x07\f\`a\vabd\x07ce\x07dcdeefg\x07gh&hij\x07jk(kllmn\x07noo\x1Bptqt rt"spsqsrtuv\x07vw\x07wx\x07xyz\x07z\x7F${|\x07|~$}{~\x81\x7F}\x7F\x80\x80\x83\x81\x7F\x82\x84\x07\x83\x82\x83\x84\x84\x85\x85\x86\x07\x86!\x87\x88\x07\x88\x89 \x89\x8A\x07\x8A\x8B\x07\x8B#\x8C\x8E\x07\x8D\x8F\x07\x8E\x8D\x8E\x8F\x8F%\x90\x91\x07\x91'\x92\x93\x07\x93)\r-3?HUWds\x7F\x83\x8E`;var _e=class extends f.ParserRuleContext{EOF(){return this.getToken(s.EOF,0)}query(e){return e===void 0?this.getRuleContexts(v):this.getRuleContext(e,v)}ignoredComment(e){return e===void 0?this.getRuleContexts(S):this.getRuleContext(e,S)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_input}enterRule(e){e.enterInput&&e.enterInput(this)}exitRule(e){e.exitInput&&e.exitInput(this)}accept(e){return e.visitInput?e.visitInput(this):e.visitChildren(this)}},v=class extends f.ParserRuleContext{queryDef(){return this.getRuleContext(0,xe)}statement(){return this.getRuleContext(0,re)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_query}enterRule(e){e.enterQuery&&e.enterQuery(this)}exitRule(e){e.exitQuery&&e.exitQuery(this)}accept(e){return e.visitQuery?e.visitQuery(this):e.visitChildren(this)}},xe=class extends f.ParserRuleContext{OPEN_COMMENT(){return this.getToken(s.OPEN_COMMENT,0)}nameTag(){return this.getRuleContext(0,ne)}CLOSE_COMMENT(){return this.getToken(s.CLOSE_COMMENT,0)}paramTag(e){return e===void 0?this.getRuleContexts(F):this.getRuleContext(e,F)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_queryDef}enterRule(e){e.enterQueryDef&&e.enterQueryDef(this)}exitRule(e){e.exitQueryDef&&e.exitQueryDef(this)}accept(e){return e.visitQueryDef?e.visitQueryDef(this):e.visitChildren(this)}},S=class extends f.ParserRuleContext{OPEN_COMMENT(){return this.getToken(s.OPEN_COMMENT,0)}CLOSE_COMMENT(e){return e===void 0?this.getTokens(s.CLOSE_COMMENT):this.getToken(s.CLOSE_COMMENT,e)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_ignoredComment}enterRule(e){e.enterIgnoredComment&&e.enterIgnoredComment(this)}exitRule(e){e.exitIgnoredComment&&e.exitIgnoredComment(this)}accept(e){return e.visitIgnoredComment?e.visitIgnoredComment(this):e.visitChildren(this)}},re=class extends f.ParserRuleContext{statementBody(){return this.getRuleContext(0,se)}EOF_STATEMENT(){return this.getToken(s.EOF_STATEMENT,0)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_statement}enterRule(e){e.enterStatement&&e.enterStatement(this)}exitRule(e){e.exitStatement&&e.exitStatement(this)}accept(e){return e.visitStatement?e.visitStatement(this):e.visitChildren(this)}},se=class extends f.ParserRuleContext{LINE_COMMENT(e){return e===void 0?this.getTokens(s.LINE_COMMENT):this.getToken(s.LINE_COMMENT,e)}ignoredComment(e){return e===void 0?this.getRuleContexts(S):this.getRuleContext(e,S)}param(e){return e===void 0?this.getRuleContexts(Q):this.getRuleContext(e,Q)}word(e){return e===void 0?this.getRuleContexts(M):this.getRuleContext(e,M)}range(e){return e===void 0?this.getRuleContexts(B):this.getRuleContext(e,B)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_statementBody}enterRule(e){e.enterStatementBody&&e.enterStatementBody(this)}exitRule(e){e.exitStatementBody&&e.exitStatementBody(this)}accept(e){return e.visitStatementBody?e.visitStatementBody(this):e.visitChildren(this)}},M=class extends f.ParserRuleContext{WORD(){return this.tryGetToken(s.WORD,0)}ID(){return this.tryGetToken(s.ID,0)}STRING(){return this.tryGetToken(s.STRING,0)}S_REQUIRED_MARK(){return this.tryGetToken(s.S_REQUIRED_MARK,0)}DOLLAR_STRING(){return this.tryGetToken(s.DOLLAR_STRING,0)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_word}enterRule(e){e.enterWord&&e.enterWord(this)}exitRule(e){e.exitWord&&e.exitWord(this)}accept(e){return e.visitWord?e.visitWord(this):e.visitChildren(this)}},B=class extends f.ParserRuleContext{PARAM_MARK(){return this.getToken(s.PARAM_MARK,0)}word(){return this.getRuleContext(0,M)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_range}enterRule(e){e.enterRange&&e.enterRange(this)}exitRule(e){e.exitRange&&e.exitRange(this)}accept(e){return e.visitRange?e.visitRange(this):e.visitChildren(this)}},Q=class extends f.ParserRuleContext{PARAM_MARK(){return this.getToken(s.PARAM_MARK,0)}paramId(){return this.getRuleContext(0,ie)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_param}enterRule(e){e.enterParam&&e.enterParam(this)}exitRule(e){e.exitParam&&e.exitParam(this)}accept(e){return e.visitParam?e.visitParam(this):e.visitChildren(this)}},ie=class extends f.ParserRuleContext{ID(){return this.getToken(s.ID,0)}S_REQUIRED_MARK(){return this.tryGetToken(s.S_REQUIRED_MARK,0)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_paramId}enterRule(e){e.enterParamId&&e.enterParamId(this)}exitRule(e){e.exitParamId&&e.exitParamId(this)}accept(e){return e.visitParamId?e.visitParamId(this):e.visitChildren(this)}},ne=class extends f.ParserRuleContext{NAME_TAG(){return this.getToken(s.NAME_TAG,0)}queryName(){return this.getRuleContext(0,ce)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_nameTag}enterRule(e){e.enterNameTag&&e.enterNameTag(this)}exitRule(e){e.exitNameTag&&e.exitNameTag(this)}accept(e){return e.visitNameTag?e.visitNameTag(this):e.visitChildren(this)}},F=class extends f.ParserRuleContext{TYPE_TAG(){return this.getToken(s.TYPE_TAG,0)}paramName(){return this.getRuleContext(0,le)}paramTransform(){return this.getRuleContext(0,ae)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_paramTag}enterRule(e){e.enterParamTag&&e.enterParamTag(this)}exitRule(e){e.exitParamTag&&e.exitParamTag(this)}accept(e){return e.visitParamTag?e.visitParamTag(this):e.visitChildren(this)}},ae=class extends f.ParserRuleContext{TRANSFORM_ARROW(){return this.getToken(s.TRANSFORM_ARROW,0)}transformRule(){return this.getRuleContext(0,ue)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_paramTransform}enterRule(e){e.enterParamTransform&&e.enterParamTransform(this)}exitRule(e){e.exitParamTransform&&e.exitParamTransform(this)}accept(e){return e.visitParamTransform?e.visitParamTransform(this):e.visitChildren(this)}},ue=class extends f.ParserRuleContext{spreadTransform(){return this.tryGetRuleContext(0,he)}pickTransform(){return this.tryGetRuleContext(0,w)}spreadPickTransform(){return this.tryGetRuleContext(0,oe)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_transformRule}enterRule(e){e.enterTransformRule&&e.enterTransformRule(this)}exitRule(e){e.exitTransformRule&&e.exitTransformRule(this)}accept(e){return e.visitTransformRule?e.visitTransformRule(this):e.visitChildren(this)}},he=class extends f.ParserRuleContext{OB(){return this.getToken(s.OB,0)}SPREAD(){return this.getToken(s.SPREAD,0)}CB(){return this.getToken(s.CB,0)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_spreadTransform}enterRule(e){e.enterSpreadTransform&&e.enterSpreadTransform(this)}exitRule(e){e.exitSpreadTransform&&e.exitSpreadTransform(this)}accept(e){return e.visitSpreadTransform?e.visitSpreadTransform(this):e.visitChildren(this)}},w=class extends f.ParserRuleContext{OB(){return this.getToken(s.OB,0)}key(e){return e===void 0?this.getRuleContexts(H):this.getRuleContext(e,H)}CB(){return this.getToken(s.CB,0)}COMMA(e){return e===void 0?this.getTokens(s.COMMA):this.getToken(s.COMMA,e)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_pickTransform}enterRule(e){e.enterPickTransform&&e.enterPickTransform(this)}exitRule(e){e.exitPickTransform&&e.exitPickTransform(this)}accept(e){return e.visitPickTransform?e.visitPickTransform(this):e.visitChildren(this)}},oe=class extends f.ParserRuleContext{OB(){return this.getToken(s.OB,0)}pickTransform(){return this.getRuleContext(0,w)}SPREAD(){return this.getToken(s.SPREAD,0)}CB(){return this.getToken(s.CB,0)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_spreadPickTransform}enterRule(e){e.enterSpreadPickTransform&&e.enterSpreadPickTransform(this)}exitRule(e){e.exitSpreadPickTransform&&e.exitSpreadPickTransform(this)}accept(e){return e.visitSpreadPickTransform?e.visitSpreadPickTransform(this):e.visitChildren(this)}},H=class extends f.ParserRuleContext{ID(){return this.getToken(s.ID,0)}C_REQUIRED_MARK(){return this.tryGetToken(s.C_REQUIRED_MARK,0)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_key}enterRule(e){e.enterKey&&e.enterKey(this)}exitRule(e){e.exitKey&&e.exitKey(this)}accept(e){return e.visitKey?e.visitKey(this):e.visitChildren(this)}},ce=class extends f.ParserRuleContext{ID(){return this.getToken(s.ID,0)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_queryName}enterRule(e){e.enterQueryName&&e.enterQueryName(this)}exitRule(e){e.exitQueryName&&e.exitQueryName(this)}accept(e){return e.visitQueryName?e.visitQueryName(this):e.visitChildren(this)}},le=class extends f.ParserRuleContext{ID(){return this.getToken(s.ID,0)}constructor(e,x){super(e,x)}get ruleIndex(){return s.RULE_paramName}enterRule(e){e.enterParamName&&e.enterParamName(this)}exitRule(e){e.exitParamName&&e.exitParamName(this)}accept(e){return e.visitParamName?e.visitParamName(this):e.visitChildren(this)}};var mt=require("antlr4ts/misc/index.js"),T;(function(t){t.Scalar="scalar",t.PickTuple="pick_tuple",t.ArraySpread="array_spread",t.PickArraySpread="pick_array_spread"})(T||(T={}));function K(t){if(!t)throw new Error("Assertion Failed")}function dt({name:t,required:e},x,r,n){let h=x,c=[],a,u=r;if(u)a=`$${u.assignedIndex}`;else{let A=++h;if(a=`$${A}`,u={assignedIndex:A,type:0,name:t,required:e},n){let o=n[t];c.push(o)}}return{bindings:c,replacement:a,nextIndex:h,config:u}}function pt({name:t,required:e},x,r,n){let h=x,c=[],a=r,u=[];a?u=a.assignedIndex:(n?u=n[t].map(m=>(c.push(m),++h)):u=[++h],a={assignedIndex:u,type:1,name:t,required:e});let A="("+u.map(o=>`$${o}`).join(", ")+")";return{bindings:c,replacement:A,nextIndex:h,config:a}}function Rt(t,e,x,r,n){let h=x,c=[],a=r||{name:t,type:2,dict:{}},A="("+e.map(({name:o,required:m})=>{if(o in a.dict)return a.dict[o].required=a.dict[o].required||m,`$${a.dict[o].assignedIndex}`;let d=++h;if(a.dict[o]={assignedIndex:d,name:o,required:m,type:0},n){let I=n[t][o];c.push(I)}return`$${d}`}).join(", ")+")";return{bindings:c,replacement:A,nextIndex:h,config:a}}function ft(t,e,x,r,n){let h=x,c=[],a=r||{name:t,type:3,dict:{}},u;if(n){let A=n[t];A.length>0?u=A.map(o=>e.map(({name:m})=>(c.push(o[m]),`$${++h}`)).join(", ")).map(o=>`(${o})`).join(", "):u="()"}else u="("+e.map(({name:o,required:m})=>{if(o in a.dict)return`$${a.dict[o].assignedIndex}`;let d=++h;return a.dict[o]={assignedIndex:d,name:o,required:m,type:0},`$${d}`}).join(", ")+")";return{bindings:c,replacement:u,nextIndex:h,config:a}}var C=(t,e)=>{let x=[],r={},n=0,h=[];for(let a of t.params){let u,A=[],o,m;if(a.selection.type===_.Scalar){let d=r[a.name];m=dt(a,n,d,e)}if(a.selection.type===_.ScalarArray){let d=r[a.name];m=pt(a,n,d,e)}if(a.selection.type===_.Object){let d=r[a.name]||{name:a.name,type:2,dict:{}};m=Rt(a.name,a.selection.keys,n,d,e)}if(a.selection.type===_.ObjectArray){let d=r[a.name]||{name:a.name,type:3,dict:{}};m=ft(a.name,a.selection.keys,n,d,e)}K(m),{config:o,nextIndex:n,replacement:u,bindings:A}=m,r[a.name]=o,x.push(...A),h.push({a:a.location.a,b:a.location.b,sub:u})}let c=Y(t.text,h);return{mapping:e?[]:Object.values(r),query:c,bindings:x}};var G=(t,e)=>{let x=[],r=[],n=t.params.filter(u=>u.name in t.usedParamSet),h=1,c=[];for(let u of n){if(u.transform.type===T.ArraySpread){let o;if(e)o=e[u.name].map(d=>(x.push(d),`$${h++}`)).join(",");else{let m=h++;r.push({name:u.name,type:1,assignedIndex:m,required:u.required}),o=`$${m}`}u.locs.forEach(m=>c.push({...m,sub:`(${o})`}));continue}if(u.transform.type===T.PickTuple){let o={},m=u.transform.keys.map(({name:d,required:I})=>{let P=h++;if(o[d]={name:d,required:I,type:0,assignedIndex:P},e){let et=e[u.name][d];x.push(et)}return`$${P}`}).join(",");e||r.push({name:u.name,type:2,dict:o}),u.locs.forEach(d=>c.push({...d,sub:`(${m})`}));continue}if(u.transform.type===T.PickArraySpread){let o;if(e)o=e[u.name].map(d=>(K(u.transform.type===T.PickArraySpread),u.transform.keys.map(({name:P})=>{let ge=d[P];return x.push(ge),`$${h++}`}).join(","))).join("),(");else{let m={};o=u.transform.keys.map(({name:d,required:I})=>{let P=h++;return m[d]={name:d,required:I,type:0,assignedIndex:P},`$${P}`}).join(","),r.push({name:u.name,type:3,dict:m})}u.locs.forEach(m=>c.push({...m,sub:`(${o})`}));continue}let A=h++;if(e){let o=e[u.name];x.push(o)}else r.push({name:u.name,type:0,assignedIndex:A,required:u.required});u.locs.forEach(o=>c.push({...o,sub:`$${A}`}))}let a=Y(t.statement,c);return{mapping:r,query:a,bindings:x}};function At(t){let e=t[t.length-1];return e==="!"||e==="?"}function q(t){for(let e of t)for(let x in e)if(At(x)){let r=x.slice(0,-1);e[r]=e[x],delete e[x]}return t}var Te=class extends Error{constructor(){super("Not found"),this.name="NotFoundError"}},Pe=class extends Error{constructor(){super("Too many rows"),this.name="TooManyRowsError"}},W=class{constructor(e){this.query=e,this.run=async(x,r)=>{let{query:n,bindings:h}=C(this.query,x),c=await r.query(n,h);return q(c.rows)},this.one=async(x,r)=>{let{query:n,bindings:h}=C(this.query,x),c=await r.query(n,h),a=q(c.rows);if(a.length===0)throw new Te;if(a.length>1)throw new Pe;return a[0]},this.stream=(x,r)=>{let{query:n,bindings:h}=C(this.query,x);if(r.stream==null)throw new Error("Connection doesn't support streaming.");let c=r.stream(n,h);return{async read(a){let u=await c.read(a);return q(u)},async close(){await c.close()}}}}},Xe=t=>{let{query:e}=Ae(t[0]);return new W(e)},me=class{constructor(e){this.queryIR=e,this.run=async(x,r)=>{let{query:n,bindings:h}=G(this.queryIR,x),c=await r.query(n,h);return q(c.rows)},this.stream=(x,r)=>{let{query:n,bindings:h}=G(this.queryIR,x);if(r.stream==null)throw new Error("Connection doesn't support streaming.");let c=r.stream(n,h);return{async read(a){let u=await c.read(a);return q(u)},async close(){await c.close()}}}}};0&&(module.exports={ParameterTransform,PreparedQuery,TaggedQuery,processSQLQueryIR,processTSQueryAST,sql});
//# sourceMappingURL=index.cjs.map
